module.exports=[70406,(e,t,r)=>{t.exports=e.x("next/dist/compiled/@opentelemetry/api",()=>require("next/dist/compiled/@opentelemetry/api"))},18622,(e,t,r)=>{t.exports=e.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},56704,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},32319,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},24725,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/after-task-async-storage.external.js",()=>require("next/dist/server/app-render/after-task-async-storage.external.js"))},14747,(e,t,r)=>{t.exports=e.x("path",()=>require("path"))},22734,(e,t,r)=>{t.exports=e.x("fs",()=>require("fs"))},93695,(e,t,r)=>{t.exports=e.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},30056,e=>e.a(async(t,r)=>{try{let t=await e.y("pg");e.n(t),r()}catch(e){r(e)}},!0),18398,e=>e.a(async(t,r)=>{try{var a=e.i(64051),n=t([a]);async function s(e){try{if(!e||"default"===e)return(0,a.getSupabaseClient)({mode:"service",databaseUrl:process.env.DATABASE_URL});let t=await (0,a.getSupabaseClient)({mode:"service"}),{data:r,error:n}=await t.from("database_connections").select("supabase_url, supabase_service_role_key, supabase_anon_key, database_url").eq("id",e).single();if(n||!r)return null;return(0,a.getSupabaseClient)({url:r.supabase_url,key:r.supabase_service_role_key||r.supabase_anon_key,mode:r.supabase_service_role_key?"service":"public",databaseUrl:r.database_url})}catch(e){return console.error("Database client error:",e),null}}[a]=n.then?(await n)():n,e.s(["createDatabaseClient",()=>s]),r()}catch(e){r(e)}},!1),72049,e=>e.a(async(t,r)=>{try{var a=e.i(89171),n=e.i(18398),s=t([n]);async function o(e){try{let{table:t,query:r,joins:s=[],selectedColumns:o=[],databaseId:l}=await e.json();if(!t)return a.NextResponse.json({error:"Table name is required"},{status:400});let u=await (0,n.createDatabaseClient)(l);if(!u)return a.NextResponse.json({error:"Database not found"},{status:404});let c=function(e,t,r,a){let n="main",s="SELECT ";if(0===a.length?(s+=`${n}.*`,r.forEach((e,t)=>{s+=`, j${t}.*`})):s+=a?.map(t=>{let a=t.table===e?n:`j${r.findIndex(e=>e.targetTable===t.table)}`;return`${a}.${i(t.column)} AS ${i(t.alias)}`}).join(", "),s+=` FROM ${i(e)} AS ${n}`,r.forEach((e,t)=>{let r=`j${t}`;s+=` ${e.type} JOIN ${i(e.targetTable)} AS ${r}`,s+=` ON ${n}.${i(e.sourceColumn)} = ${r}.${i(e.targetColumn)}`}),t?.rules?.length>0){let a=function e(t,r,a,n){let s=[];for(let o of t.rules)if("rules"in o){let t=e(o,r,a,n);t.trim()&&s.push(`(${t})`)}else o.field&&o.operator&&s.push(function(e,t,r,a){let n;if(e.field.includes(".")){let[s,o]=e.field.split("."),l=s===r?t:`j${a.findIndex(e=>e.targetTable===s)}`;n=`${l}.${i(o)}`}else n=`${t}.${i(e.field)}`;let s=e=>null!=e&&""!==e&&!isNaN(Number(e))&&!isNaN(parseFloat(String(e))),o=(e,t)=>{if(null==e)return"NULL";if(s(e))return String(Number(e));let r=String(e).replace(/'/g,"''");return t?`unaccent(lower('${r}'))`:`'${r}'`},l=["contains","beginsWith","endsWith"].includes(e.operator)||!s(e.value)&&!["null","notNull"].includes(e.operator),u=l?`unaccent(lower(CAST(${n} AS TEXT)))`:n;switch(e.operator){case"=":case"!=":return`${u} ${"="===e.operator?"=":"!="} ${o(e.value,l)}`;case"<":case">":case"<=":case">=":let c=s(e.value)?Number(e.value):`'${String(e.value).replace(/'/g,"''")}'`;return`${n} ${e.operator} ${c}`;case"contains":return`unaccent(lower(CAST(${n} AS TEXT))) LIKE unaccent(lower('%${String(e.value).replace(/'/g,"''")}%'))`;case"beginsWith":return`unaccent(lower(CAST(${n} AS TEXT))) LIKE unaccent(lower('${String(e.value).replace(/'/g,"''")}%'))`;case"endsWith":return`unaccent(lower(CAST(${n} AS TEXT))) LIKE unaccent(lower('%${String(e.value).replace(/'/g,"''")}'))`;case"null":return`${n} IS NULL`;case"notNull":return`${n} IS NOT NULL`;case"in":let d=Array.isArray(e.value)?e.value?.map(e=>o(e,l)).join(", "):o(e.value,l);return l?`${u} IN (${d})`:`${n} IN (${d})`;default:return`${u} = ${o(e.value,l)}`}}(o,r,a,n));return s.join(` ${t.combinator.toUpperCase()} `)}(t,n,e,r);a.trim()&&(s+=` WHERE ${a}`)}return s}(t,r,s,o),{data:d,error:p}=await u.rpc("execute_dynamic_query",{p_query_text:c});if(p)return a.NextResponse.json({success:!1,userMessage:"Query syntax error. Please check your filters.",devMessage:p.message},{status:400});let h="true"===process.env.DEBUG_MODE;return a.NextResponse.json({success:!0,table:t,count:d?.length||0,data:d,hasJoins:s.length>0,sqlQuery:h?c:null})}catch(e){return console.error("Query execution error:",e),a.NextResponse.json({success:!1,userMessage:"Internal query execution error.",devMessage:e.message},{status:500})}}function i(e){return`"${e.replace(/"/g,'""')}"`}[n]=s.then?(await s)():s,e.s(["POST",()=>o]),r()}catch(e){r(e)}},!1),61325,e=>e.a(async(t,r)=>{try{var a=e.i(47909),n=e.i(74017),s=e.i(96250),o=e.i(59756),i=e.i(61916),l=e.i(14444),u=e.i(37092),c=e.i(69741),d=e.i(16795),p=e.i(87718),h=e.i(95169),x=e.i(47587),g=e.i(66012),f=e.i(70101),v=e.i(26937),y=e.i(10372),R=e.i(93695);e.i(52474);var m=e.i(220),b=e.i(72049),w=t([b]);[b]=w.then?(await w)():w;let C=new a.AppRouteRouteModule({definition:{kind:n.RouteKind.APP_ROUTE,page:"/api/query/route",pathname:"/api/query",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/app/api/query/route.ts",nextConfigOutput:"",userland:b}),{workAsyncStorage:S,workUnitAsyncStorage:A,serverHooks:N}=C;function $(){return(0,s.patchFetch)({workAsyncStorage:S,workUnitAsyncStorage:A})}async function E(e,t,r){C.isDev&&(0,o.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let a="/api/query/route";a=a.replace(/\/index$/,"")||"/";let s=await C.prepare(e,t,{srcPage:a,multiZoneDraftMode:!1});if(!s)return t.statusCode=400,t.end("Bad Request"),null==r.waitUntil||r.waitUntil.call(r,Promise.resolve()),null;let{buildId:b,params:w,nextConfig:$,parsedUrl:E,isDraftMode:S,prerenderManifest:A,routerServerContext:N,isOnDemandRevalidate:T,revalidateOnlyGenerated:_,resolvedPathname:q,clientReferenceManifest:j,serverActionsManifest:k}=s,O=(0,c.normalizeAppPath)(a),I=!!(A.dynamicRoutes[O]||A.routes[q]),P=async()=>((null==N?void 0:N.render404)?await N.render404(e,t,E,!1):t.end("This page could not be found"),null);if(I&&!S){let e=!!A.routes[q],t=A.dynamicRoutes[O];if(t&&!1===t.fallback&&!e){if($.experimental.adapterPath)return await P();throw new R.NoFallbackError}}let U=null;!I||C.isDev||S||(U=q,U="/index"===U?"/":U);let M=!0===C.isDev||!I,D=I&&!M;k&&j&&(0,l.setReferenceManifestsSingleton)({page:a,clientReferenceManifest:j,serverActionsManifest:k,serverModuleMap:(0,u.createServerModuleMap)({serverActionsManifest:k})});let H=e.method||"GET",L=(0,i.getTracer)(),K=L.getActiveScopeSpan(),F={params:w,prerenderManifest:A,renderOpts:{experimental:{authInterrupts:!!$.experimental.authInterrupts},cacheComponents:!!$.cacheComponents,supportsDynamicResponse:M,incrementalCache:(0,o.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:$.cacheLife,waitUntil:r.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,r,a)=>C.onRequestError(e,t,a,N)},sharedContext:{buildId:b}},B=new d.NodeNextRequest(e),W=new d.NodeNextResponse(t),X=p.NextRequestAdapter.fromNodeNextRequest(B,(0,p.signalFromNodeResponse)(t));try{let s=async e=>C.handle(X,F).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let r=L.getRootSpanAttributes();if(!r)return;if(r.get("next.span_type")!==h.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${r.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let n=r.get("next.route");if(n){let t=`${H} ${n}`;e.setAttributes({"next.route":n,"http.route":n,"next.span_name":t}),e.updateName(t)}else e.updateName(`${H} ${a}`)}),l=!!(0,o.getRequestMeta)(e,"minimalMode"),u=async o=>{var i,u;let c=async({previousCacheEntry:n})=>{try{if(!l&&T&&_&&!n)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let a=await s(o);e.fetchMetrics=F.renderOpts.fetchMetrics;let i=F.renderOpts.pendingWaitUntil;i&&r.waitUntil&&(r.waitUntil(i),i=void 0);let u=F.renderOpts.collectedTags;if(!I)return await (0,g.sendResponse)(B,W,a,F.renderOpts.pendingWaitUntil),null;{let e=await a.blob(),t=(0,f.toNodeOutgoingHttpHeaders)(a.headers);u&&(t[y.NEXT_CACHE_TAGS_HEADER]=u),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let r=void 0!==F.renderOpts.collectedRevalidate&&!(F.renderOpts.collectedRevalidate>=y.INFINITE_CACHE)&&F.renderOpts.collectedRevalidate,n=void 0===F.renderOpts.collectedExpire||F.renderOpts.collectedExpire>=y.INFINITE_CACHE?void 0:F.renderOpts.collectedExpire;return{value:{kind:m.CachedRouteKind.APP_ROUTE,status:a.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:r,expire:n}}}}catch(t){throw(null==n?void 0:n.isStale)&&await C.onRequestError(e,t,{routerKind:"App Router",routePath:a,routeType:"route",revalidateReason:(0,x.getRevalidateReason)({isStaticGeneration:D,isOnDemandRevalidate:T})},N),t}},d=await C.handleResponse({req:e,nextConfig:$,cacheKey:U,routeKind:n.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:A,isRoutePPREnabled:!1,isOnDemandRevalidate:T,revalidateOnlyGenerated:_,responseGenerator:c,waitUntil:r.waitUntil,isMinimalMode:l});if(!I)return null;if((null==d||null==(i=d.value)?void 0:i.kind)!==m.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==d||null==(u=d.value)?void 0:u.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});l||t.setHeader("x-nextjs-cache",T?"REVALIDATED":d.isMiss?"MISS":d.isStale?"STALE":"HIT"),S&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let p=(0,f.fromNodeOutgoingHttpHeaders)(d.value.headers);return l&&I||p.delete(y.NEXT_CACHE_TAGS_HEADER),!d.cacheControl||t.getHeader("Cache-Control")||p.get("Cache-Control")||p.set("Cache-Control",(0,v.getCacheControlHeader)(d.cacheControl)),await (0,g.sendResponse)(B,W,new Response(d.value.body,{headers:p,status:d.value.status||200})),null};K?await u(K):await L.withPropagatedContext(e.headers,()=>L.trace(h.BaseServerSpan.handleRequest,{spanName:`${H} ${a}`,kind:i.SpanKind.SERVER,attributes:{"http.method":H,"http.target":e.url}},u))}catch(t){if(t instanceof R.NoFallbackError||await C.onRequestError(e,t,{routerKind:"App Router",routePath:O,routeType:"route",revalidateReason:(0,x.getRevalidateReason)({isStaticGeneration:D,isOnDemandRevalidate:T})}),I)throw t;return await (0,g.sendResponse)(B,W,new Response(null,{status:500})),null}}e.s(["handler",()=>E,"patchFetch",()=>$,"routeModule",()=>C,"serverHooks",()=>N,"workAsyncStorage",()=>S,"workUnitAsyncStorage",()=>A]),r()}catch(e){r(e)}},!1)];

//# sourceMappingURL=%5Broot-of-the-server%5D__31232f60._.js.map